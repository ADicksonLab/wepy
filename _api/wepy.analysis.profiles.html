
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>wepy.analysis.profiles module &#8212; Wepy Documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="canonical" href="https://adicksonlab.github.io/wepy/_api/wepy.analysis.profiles.html" />
    <link rel="shortcut icon" href="../_static/wepy-icon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="wepy.analysis.rates module" href="wepy.analysis.rates.html" />
    <link rel="prev" title="wepy.analysis.parents module" href="wepy.analysis.parents.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="wepy.analysis.parents.html" title="Previous document">wepy.analysis.parents module</a>
        </li>
        <li>
          <a href="wepy.analysis.rates.html" title="Next document">wepy.analysis.rates module</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <div class="section" id="module-wepy.analysis.profiles">
<span id="wepy-analysis-profiles-module"></span><h1>wepy.analysis.profiles module<a class="headerlink" href="#module-wepy.analysis.profiles" title="Permalink to this headline">¶</a></h1>
<p>Analysis routines for generating free energy profiles over wepy
simulation data.</p>
<dl class="py function">
<dt id="wepy.analysis.profiles._percentage_cumulative_partitions">
<code class="sig-prename descclassname">wepy.analysis.profiles.</code><code class="sig-name descname">_percentage_cumulative_partitions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ensemble_values</span></em>, <em class="sig-param"><span class="n">percentages</span><span class="o">=</span><span class="default_value">[0.25, 0.5, 0.75, 1.0]</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/profiles.html#_percentage_cumulative_partitions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.profiles._percentage_cumulative_partitions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="wepy.analysis.profiles._tranche_cumulative_partitions">
<code class="sig-prename descclassname">wepy.analysis.profiles.</code><code class="sig-name descname">_tranche_cumulative_partitions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ensemble_values</span></em>, <em class="sig-param"><span class="n">time_tranche</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_partitions</span><span class="o">=</span><span class="default_value">4</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/profiles.html#_tranche_cumulative_partitions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.profiles._tranche_cumulative_partitions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="wepy.analysis.profiles.cumulative_partitions">
<code class="sig-prename descclassname">wepy.analysis.profiles.</code><code class="sig-name descname">cumulative_partitions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ensemble_values</span></em>, <em class="sig-param"><span class="n">time_tranche</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_partitions</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">percentages</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/profiles.html#cumulative_partitions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.profiles.cumulative_partitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the cumulative free energies for an ensemble of
trajectory weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ensemble_values</strong> (<em>arraylikes of float of shape</em><em> (</em><em>n_cycles</em><em>, </em><em>n_trajs</em><em>)</em>) – Array of scalar values for all of the frames of an ensemble simulation.</p></li>
<li><p><strong>time_tranche</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Width of time-bins/windows/tranche to compute free energies
for. This overrides the functionality of the ‘partitions’
argument. The last tranche will be truncated to the remainder
after partitioning by tranches.</p></li>
<li><p><strong>num_partitions</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Will evenly partition the time coordinate given the
dataset. The first partition will carry the
remainder. Overriden by time_tranche.</p></li>
<li><p><strong>percentages</strong> (<em>list of float</em><em>, </em><em>optional</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><strong>cumulative_tranche</strong> (<em>arraylike</em>) – A slice along the cycles axis of the ensemble values starting
at the beginning and including up to the end of the next
tranche.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="wepy.analysis.profiles.free_energy_profile">
<code class="sig-prename descclassname">wepy.analysis.profiles.</code><code class="sig-name descname">free_energy_profile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weights</span></em>, <em class="sig-param"><span class="n">observables</span></em>, <em class="sig-param"><span class="n">bins</span><span class="o">=</span><span class="default_value">30</span></em>, <em class="sig-param"><span class="n">max_energy</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">zero_point_energy</span><span class="o">=</span><span class="default_value">1e-12</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/profiles.html#free_energy_profile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.profiles.free_energy_profile" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> (<em>arraylikes of float of shape</em><em> (</em><em>n_trajs</em><em>, </em><em>n_cycles</em><em>)</em>) – The weights for all of the frames of an ensemble simulation.</p></li>
<li><p><strong>observables</strong> (<em>arraylikes of shape</em><em> (</em><em>n_trajs</em><em>, </em><em>n_cycles</em><em>)</em>) – The scalar observables to compute the free energy over.</p></li>
<li><p><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><em>sequence of scalars</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The number of bins to bin along the observable axis, or the
actual bin edges, or the spec for the binning method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>hist_fe</strong> (<em>arraylike</em>) – The free energies of the histogram bins</p></li>
<li><p><strong>bin_edges</strong> (<em>arraylike</em>) – The edges of the bins of the histogram.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="wepy.analysis.profiles.contigtrees_bin_edges">
<code class="sig-prename descclassname">wepy.analysis.profiles.</code><code class="sig-name descname">contigtrees_bin_edges</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contigtrees</span></em>, <em class="sig-param"><span class="n">bins</span></em>, <em class="sig-param"><span class="n">field_key</span></em>, <em class="sig-param"><span class="n">truncate_cycles</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/profiles.html#contigtrees_bin_edges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.profiles.contigtrees_bin_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the bin edges that best describes the aggregate data for
multiple contigtrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contigtrees</strong> (<em>list of ContigTree objects</em>) – The contigtrees to draw the data from.</p></li>
<li><p><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><em>sequence of scalars</em><em> or </em><em>function</em>) – The number of bins to make or the method to use for
autobinning or the actual specification of bins. See
<cite>numpy.histogram_bin_edges</cite> for exact meaning and methods.</p></li>
<li><p><strong>field_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The trajectory field key for the values to get bins for.</p></li>
<li><p><strong>truncate_cycles</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – If None include all cycles of a run. Otherwise only consider
cycles for spans up to (exclusive) the cycle index given.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>bin_edges</strong> – The edges to pass into <cite>numpy.histogram</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array of dtype float</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.histogram_bin_edges()</span></code></dt><dd><p>For the bin edge function</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py class">
<dt id="wepy.analysis.profiles.ContigTreeProfiler">
<em class="property">class </em><code class="sig-prename descclassname">wepy.analysis.profiles.</code><code class="sig-name descname">ContigTreeProfiler</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contigtree</span></em>, <em class="sig-param"><span class="n">truncate_cycles</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/profiles.html#ContigTreeProfiler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.profiles.ContigTreeProfiler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A wrapper class around a ContigTree that provides extra methods for
generating free energy profiles for observables.</p>
<p>Create a wrapper around a contigtree for the profiler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contigtree</strong> (<em>ContigTree object</em>) – The contigtree you want to generate profiles for.</p></li>
<li><p><strong>truncate_cycles</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – If None include all cycles of a run. Otherwise only consider
cycles for spans up to (exclusive) the cycle index given.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="wepy.analysis.profiles.ContigTreeProfiler._get_ignore_trace">
<em class="property">classmethod </em><code class="sig-name descname">_get_ignore_trace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contigtree</span></em>, <em class="sig-param"><span class="n">truncate_cycles</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/profiles.html#ContigTreeProfiler._get_ignore_trace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.profiles.ContigTreeProfiler._get_ignore_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a trace of the ignore frames if we are truncating on a
particular cycle index. Is exclusive of the <cite>truncate_cycles</cite>
value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contigtree</strong> (<a class="reference internal" href="../api/wepy.analysis.contig_tree.html#wepy.analysis.contig_tree.ContigTree" title="wepy.analysis.contig_tree.ContigTree"><em>ContigTree</em></a>) – </p></li>
<li><p><strong>truncate_cycles</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The cycle index to truncate at (exclusive).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ignored_trace</strong> – The frames to ignore given the truncation.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>set of (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.profiles.ContigTreeProfiler.contigtree">
<em class="property">property </em><code class="sig-name descname">contigtree</code><a class="headerlink" href="#wepy.analysis.profiles.ContigTreeProfiler.contigtree" title="Permalink to this definition">¶</a></dt>
<dd><p>The underlying contigtree this wraps.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.profiles.ContigTreeProfiler.fe_profile_trace">
<code class="sig-name descname">fe_profile_trace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">trace</span></em>, <em class="sig-param"><span class="n">field_key</span></em>, <em class="sig-param"><span class="n">bins</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ignore_truncate</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/profiles.html#ContigTreeProfiler.fe_profile_trace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.profiles.ContigTreeProfiler.fe_profile_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the free energy histogram over a trajectory field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace</strong> (<em>list of tuple of ints</em><em> (</em><em>run_idx</em><em>, </em><em>traj_idx</em><em>, </em><em>cycle_idx</em><em>)</em>) – </p></li>
<li><p><strong>field_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The key for the trajectory field to calculate the profiles
for. Must be a rank 0 (or equivalent (1,) rank) field.</p></li>
<li><p><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><em>sequence of scalars</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a>) – The number of bins to bin along the observable axis, or
the actual bin edges, or the spec for the binning method,
or None. If None will generate them with the ‘auto’
setting for this span.</p></li>
<li><p><strong>ignore_truncate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Ignore the truncate_cycles value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fe_profile</strong> – An array of free energies for each bin.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>arraylike of dtype float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.profiles.ContigTreeProfiler.fe_profile_all">
<code class="sig-name descname">fe_profile_all</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">field_key</span></em>, <em class="sig-param"><span class="n">bins</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ignore_truncate</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/profiles.html#ContigTreeProfiler.fe_profile_all"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.profiles.ContigTreeProfiler.fe_profile_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the free energy histogram over a trajectory field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The key for the trajectory field to calculate the profiles
for. Must be a rank 0 (or equivalent (1,) rank) field.</p></li>
<li><p><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><em>sequence of scalars</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a>) – The number of bins to bin along the observable axis, or
the actual bin edges, or the spec for the binning method,
or None. If None will generate them with the ‘auto’
setting for this span.</p></li>
<li><p><strong>ignore_truncate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Ignore the truncate_cycles value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fe_profile</strong> – An array of free energies for each bin.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>arraylike of dtype float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.profiles.ContigTreeProfiler.fe_profile">
<code class="sig-name descname">fe_profile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">span</span></em>, <em class="sig-param"><span class="n">field_key</span></em>, <em class="sig-param"><span class="n">bins</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ignore_truncate</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/profiles.html#ContigTreeProfiler.fe_profile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.profiles.ContigTreeProfiler.fe_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the free energy histogram over a trajectory field.</p>
<p>Deprecation warning: This will likely be deprecated and
renamed to fe_profile_span because it is misleading that a
profile is span based.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>span</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The index of the span to calculate profiles for.</p></li>
<li><p><strong>field_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The key for the trajectory field to calculate the profiles
for. Must be a rank 0 (or equivalent (1,) rank) field.</p></li>
<li><p><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><em>sequence of scalars</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a>) – The number of bins to bin along the observable axis, or
the actual bin edges, or the spec for the binning method,
or None. If None will generate them with the ‘auto’
setting for this span.</p></li>
<li><p><strong>ignore_truncate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Ignore the truncate_cycles value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fe_profile</strong> – An array of free energies for each bin.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>arraylike of dtype float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.profiles.ContigTreeProfiler.fe_cumulative_profiles">
<code class="sig-name descname">fe_cumulative_profiles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">span</span></em>, <em class="sig-param"><span class="n">field_key</span></em>, <em class="sig-param"><span class="n">bins</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">time_tranche</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_partitions</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">ignore_truncate</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/profiles.html#ContigTreeProfiler.fe_cumulative_profiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.profiles.ContigTreeProfiler.fe_cumulative_profiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the cumulative free energy histograms for a trajectory
field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>span</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The index of the span to calculate profiles for.</p></li>
<li><p><strong>field_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The key for the trajectory field to calculate the profiles
for. Must be a rank 0 (or equivalent (1,) rank) field.</p></li>
<li><p><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><em>sequence of scalars</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a>) – The number of bins to bin along the observable axis, or
the actual bin edges, or the spec for the binning method,
or None. If None will generate them with the ‘auto’
setting for this span.</p></li>
<li><p><strong>time_tranche</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Width of time-bins/windows/tranche to compute free
energies for. This overrides the functionality of the
‘num_partitions’ argument. The last tranche will be truncated
to the remainder after partitioning by tranches. Overrides
partitions.</p></li>
<li><p><strong>num_partitions</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Will evenly partition the time coordinate given the
dataset. The first partition will carry the remainder.
Overriden by time_tranche.</p></li>
<li><p><strong>ignore_truncate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Ignore the truncate_cycles value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>cumulative_fe_profiles</strong> (<em>list of arraylike of dtype float</em>) – A list of each cumulative free energy profile. Each profile is
an array of free energies for each bin.</p></li>
<li><p><strong>profile_num_cycles</strong> (<em>list of int</em>) – The number of cycles in each cumulative fe profile.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.profiles.ContigTreeProfiler.fe_all_cumulative_profiles">
<code class="sig-name descname">fe_all_cumulative_profiles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">field_key</span></em>, <em class="sig-param"><span class="n">bins</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">time_tranche</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_partitions</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">percentages</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ignore_truncate</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/profiles.html#ContigTreeProfiler.fe_all_cumulative_profiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.profiles.ContigTreeProfiler.fe_all_cumulative_profiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the cumulative free energy histograms for a trajectory
field for all spans in a contigtree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The key for the trajectory field to calculate the profiles
for. Must be a rank 0 (or equivalent (1,) rank) field.</p></li>
<li><p><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><em>sequence of scalars</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a>) – The number of bins to bin along the observable axis, or
the actual bin edges, or the spec for the binning method,
or None. If None will generate them with the ‘auto’
setting for this span.</p></li>
<li><p><strong>time_tranche</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Width of time-bins/windows/tranche to compute free
energies for. This overrides the functionality of the
‘num_partitions’ argument. The last tranche will be truncated
to the remainder after partitioning by tranches. Overrides
partitions.</p></li>
<li><p><strong>num_partitions</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Will evenly partition the time coordinate given the
dataset. The first partition will carry the remainder.
Overriden by time_tranche.</p></li>
<li><p><strong>percentages</strong> (<em>list of float</em>) – </p></li>
<li><p><strong>ignore_truncate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Ignore the truncate_cycles value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>cumulative_fe_profiles</strong> (<em>list of arraylike of dtype float</em>) – A list of each cumulative free energy profile. Each profile is
an array of free energies for each bin.</p></li>
<li><p><strong>profile_num_cycles</strong> (<em>list of int</em>) – The number of cycles in each cumulative fe profile.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.profiles.ContigTreeProfiler.bin_edges">
<code class="sig-name descname">bin_edges</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bins</span></em>, <em class="sig-param"><span class="n">field_key</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/profiles.html#ContigTreeProfiler.bin_edges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.profiles.ContigTreeProfiler.bin_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the bin edges that best describes all of the contigtree
data for the number of bins.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The number of bins to make or the method to use for
autobinning.</p></li>
<li><p><strong>field_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The trajectory field key for the values to get bins for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>bin_edges</strong> – The edges to pass into <cite>numpy.histogram</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array of dtype float</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">numpy.histogram_bin_edges()</span></code></dt><dd><p>For the bin edge function</p>
</dd>
</dl>
</div>
</dd></dl>

</dd></dl>

</div>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="wepy.analysis.parents.html" title="Previous document">wepy.analysis.parents module</a>
        </li>
        <li>
          <a href="wepy.analysis.rates.html" title="Next document">wepy.analysis.rates module</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/wepy.svg" alt="Logo"/>
    
    <h1 class="logo logo-name">wepy</h1>
    
  </a>
</p>



<p class="blurb">Wepy Documentation</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=ADicksonLab&repo=wepy&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../_source/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_source/quick_start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_source/introduction.html">Introduction &amp; Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_source/introduction.html#bibliography">Bibliography</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../_source/tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_source/users_guide.html">User’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_source/troubleshooting.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_source/reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_source/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_source/api.html">API Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Full API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../_source/general_info.html">General Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_source/news.html">News and Updates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_source/changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_source/dev_guide.html">Development Guide</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="modules.html">wepy</a><ul>
  <li><a href="wepy.html">wepy package</a><ul>
  <li><a href="wepy.analysis.html">wepy.analysis package</a><ul>
      <li>Previous: <a href="wepy.analysis.parents.html" title="previous chapter">wepy.analysis.parents module</a></li>
      <li>Next: <a href="wepy.analysis.rates.html" title="next chapter">wepy.analysis.rates module</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Samuel D. Lotz.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/_api/wepy.analysis.profiles.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>