
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>wepy.analysis.contig_tree module &#8212; Wepy Documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="canonical" href="https://adicksonlab.github.io/wepy/api/wepy.analysis.contig_tree.html" />
    <link rel="shortcut icon" href="../_static/wepy-icon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <div class="section" id="module-wepy.analysis.contig_tree">
<span id="wepy-analysis-contig-tree-module"></span><h1>wepy.analysis.contig_tree module<a class="headerlink" href="#module-wepy.analysis.contig_tree" title="Permalink to this headline">¶</a></h1>
<p>Classes providing a contig and branching contigs abstractions over
the underlying WepyHDF5 simulation data store.</p>
<div class="section" id="routines">
<h2>Routines<a class="headerlink" href="#routines" title="Permalink to this headline">¶</a></h2>
<p>ContigTree
Contig</p>
<dl class="py data">
<dt id="wepy.analysis.contig_tree.RESAMPLING">
<code class="sig-prename descclassname">wepy.analysis.contig_tree.</code><code class="sig-name descname">RESAMPLING</code><em class="property"> = 'resampling'</em><a class="headerlink" href="#wepy.analysis.contig_tree.RESAMPLING" title="Permalink to this definition">¶</a></dt>
<dd><p>Record key for resampling records.</p>
</dd></dl>

<dl class="py data">
<dt id="wepy.analysis.contig_tree.RESAMPLER">
<code class="sig-prename descclassname">wepy.analysis.contig_tree.</code><code class="sig-name descname">RESAMPLER</code><em class="property"> = 'resampler'</em><a class="headerlink" href="#wepy.analysis.contig_tree.RESAMPLER" title="Permalink to this definition">¶</a></dt>
<dd><p>Record key for resampler records.</p>
</dd></dl>

<dl class="py data">
<dt id="wepy.analysis.contig_tree.WARPING">
<code class="sig-prename descclassname">wepy.analysis.contig_tree.</code><code class="sig-name descname">WARPING</code><em class="property"> = 'warping'</em><a class="headerlink" href="#wepy.analysis.contig_tree.WARPING" title="Permalink to this definition">¶</a></dt>
<dd><p>Record key for warping records.</p>
</dd></dl>

<dl class="py data">
<dt id="wepy.analysis.contig_tree.PROGRESS">
<code class="sig-prename descclassname">wepy.analysis.contig_tree.</code><code class="sig-name descname">PROGRESS</code><em class="property"> = 'progress'</em><a class="headerlink" href="#wepy.analysis.contig_tree.PROGRESS" title="Permalink to this definition">¶</a></dt>
<dd><p>Record key for progress records.</p>
</dd></dl>

<dl class="py data">
<dt id="wepy.analysis.contig_tree.BC">
<code class="sig-prename descclassname">wepy.analysis.contig_tree.</code><code class="sig-name descname">BC</code><em class="property"> = 'boundary_conditions'</em><a class="headerlink" href="#wepy.analysis.contig_tree.BC" title="Permalink to this definition">¶</a></dt>
<dd><p>Record key for boundary condition records.</p>
</dd></dl>

<dl class="py class">
<dt id="wepy.analysis.contig_tree.BaseContigTree">
<em class="property">class </em><code class="sig-prename descclassname">wepy.analysis.contig_tree.</code><code class="sig-name descname">BaseContigTree</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wepy_h5</span></em>, <em class="sig-param"><span class="n">continuations</span><span class="o">=</span><span class="default_value">Ellipsis</span></em>, <em class="sig-param"><span class="n">runs</span><span class="o">=</span><span class="default_value">Ellipsis</span></em>, <em class="sig-param"><span class="n">boundary_condition_class</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">decision_class</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A base class for the contigtree which doesn’t contain a WepyHDF5
object. Useful for serialization of the object and can then be
reattached later to a WepyHDF5.</p>
<p>The only required argument is an WepyHDF5 object from which to draw
data.</p>
<p>If <cite>continuations</cite> is given it specifies the (continuing_run_idx,
continued_run_idx) continuations the contig tree will use. This
overrides anything in the WepyHDF5 file. Only use this if you know
what you are doing. If <cite>continuations</cite> is <cite>Ellipsis</cite> the
continuations from the <cite>WepyHDF5</cite> will be used.</p>
<p>If <cite>runs</cite> is not <cite>Ellipsis</cite> only these runs will be included in
the <cite>ContigTree</cite> and the continuations relvant to this subset will
be used.</p>
<p>If a valid <cite>decision_class</cite> is given walker lineages will be
generated. This class is largely useless without this.</p>
<p>The <cite>boundary_condition_class</cite> is only used in the presence of a
<cite>decision_class</cite>. A valid <cite>boundary_condition_class</cite> will detect
the discontinuities in walker trajectories and will automatically
apply them to divide up logical trajectories. Otherwise, if
discontinuous boundary condition warping events in data are
present logical trajectories will have discontinuities in them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wepy_h5</strong> (<em>closed WepyHDF5 object</em>) – </p></li>
<li><p><strong>continuations</strong> (<em>Ellipsis</em><em> (</em><em>use continuations in wepy_h5</em><em>) </em><em>or</em>) – <p>list of tuple of int (run_idx, run_idx)</p>
<dl class="simple">
<dt>The continuations to apply to the runs in this contig tree.</dt><dd><p>(Default value = Ellipsis)</p>
</dd>
</dl>
</p></li>
<li><p><strong>runs</strong> (<em>Ellipsis</em><em> (</em><em>use all runs in wepy_h5</em><em>) </em><em>or</em>) – <p>list of idx</p>
<dl class="simple">
<dt>The indices of the runs to use in the contig tree</dt><dd><p>(Default value = Ellipsis)</p>
</dd>
</dl>
</p></li>
<li><p><strong>boundary_condition_class</strong> (<em>class implementing BoundaryCondition</em>) – interface
(Default value = None)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>decision_class<span class="classifier">class implementing Decision interface</span></dt><dd><p>(Default value = None)</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Only set <cite>continuations</cite> if you know what you are doing.</p>
<p>A <cite>decision_class</cite> must be given to be able to detect cloning and
merging and get parental lineages.</p>
<p>Make sure to give the <cite>boundary_condition_class</cite> if there was
discontinuous warping events in the simulation or else you will
get erroneous contiguous trajectories.</p>
</div>
<dl class="py attribute">
<dt id="wepy.analysis.contig_tree.BaseContigTree.RESAMPLING_PANEL_KEY">
<code class="sig-name descname">RESAMPLING_PANEL_KEY</code><em class="property"> = 'resampling_steps'</em><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.RESAMPLING_PANEL_KEY" title="Permalink to this definition">¶</a></dt>
<dd><p>Key for resampling panel node attributes in the tree graph.</p>
</dd></dl>

<dl class="py attribute">
<dt id="wepy.analysis.contig_tree.BaseContigTree.PARENTS_KEY">
<code class="sig-name descname">PARENTS_KEY</code><em class="property"> = 'parent_idxs'</em><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.PARENTS_KEY" title="Permalink to this definition">¶</a></dt>
<dd><p>Key for parent indices node attributes in the tree graph.</p>
</dd></dl>

<dl class="py attribute">
<dt id="wepy.analysis.contig_tree.BaseContigTree.DISCONTINUITY_KEY">
<code class="sig-name descname">DISCONTINUITY_KEY</code><em class="property"> = 'discontinuities'</em><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.DISCONTINUITY_KEY" title="Permalink to this definition">¶</a></dt>
<dd><p>Key for discontinuity node attributes in the tree graph.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree.graph">
<em class="property">property </em><code class="sig-name descname">graph</code><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.graph" title="Permalink to this definition">¶</a></dt>
<dd><p>The underlying networkx.DiGraph object.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree.decision_class">
<em class="property">property </em><code class="sig-name descname">decision_class</code><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.decision_class" title="Permalink to this definition">¶</a></dt>
<dd><p>The decision class used to determine parental lineages.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree.boundary_condition_class">
<em class="property">property </em><code class="sig-name descname">boundary_condition_class</code><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.boundary_condition_class" title="Permalink to this definition">¶</a></dt>
<dd><p>The boundary condition class is used to determine discontinuities in lineages.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree.span_traces">
<em class="property">property </em><code class="sig-name descname">span_traces</code><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.span_traces" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping the spand indices to their run traces.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree.span_contig">
<code class="sig-name descname">span_contig</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">span_idx</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree.span_contig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.span_contig" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a contig object for the specified spanning contig.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree._create_tree">
<code class="sig-name descname">_create_tree</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wepy_h5</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree._create_tree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree._create_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the tree of cycles from the WepyHDF5 object/file.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree._set_resampling_panels">
<code class="sig-name descname">_set_resampling_panels</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wepy_h5</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree._set_resampling_panels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree._set_resampling_panels" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates resampling panels for each cycle and sets them as node attributes.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree._set_discontinuities">
<code class="sig-name descname">_set_discontinuities</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wepy_h5</span></em>, <em class="sig-param"><span class="n">boundary_conditions_class</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree._set_discontinuities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree._set_discontinuities" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the boundary condition class sets node attributes for where
there are discontinuities in the parental lineages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>boundary_conditions_class</strong> (<em>class implementing BoundaryCondition interface</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree._set_parents">
<code class="sig-name descname">_set_parents</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">decision_class</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree._set_parents"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree._set_parents" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the net parents for each cycle and sets them in-place to
the cycle tree given.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>decision_class</strong> (<em>class implementing Decision interface</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree.run_idxs">
<em class="property">property </em><code class="sig-name descname">run_idxs</code><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.run_idxs" title="Permalink to this definition">¶</a></dt>
<dd><p>Indices of runs in WepyHDF5 used in this contig tree.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree.continuations">
<em class="property">property </em><code class="sig-name descname">continuations</code><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.continuations" title="Permalink to this definition">¶</a></dt>
<dd><p>The continuations that are used in this contig tree over the runs.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree.contig_trace_to_run_trace">
<em class="property">static </em><code class="sig-name descname">contig_trace_to_run_trace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contig_trace</span></em>, <em class="sig-param"><span class="n">contig_walker_trace</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree.contig_trace_to_run_trace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.contig_trace_to_run_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine a contig trace and a walker trace to get the equivalent run trace.</p>
<p>The contig_walker_trace cycle_idxs must be a subset of the
frame indices given by the contig_trace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contig_trace</strong> (<em>list of tuples of ints</em><em> (</em><em>run_idx</em><em>, </em><em>cycle_idx</em><em>)</em>) – </p></li>
<li><p><strong>contig_walker_trace</strong> (<em>list of tuples of ints</em><em> (</em><em>traj_idx</em><em>, </em><em>cycle_idx</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>run_trace</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuples of ints (run_idx, traj_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree.walker_trace_to_run_trace">
<code class="sig-name descname">walker_trace_to_run_trace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contig_walker_trace</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree.walker_trace_to_run_trace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.walker_trace_to_run_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine a walker trace to get the equivalent run trace for this contig.</p>
<p>The contig_walker_trace cycle_idxs must be a subset of the
frame indices given by the contig_trace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>contig_walker_trace</strong> (<em>list of tuples of ints</em><em> (</em><em>traj_idx</em><em>, </em><em>cycle_idx</em><em>)</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>run_trace</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuples of ints (run_idx, traj_idx, cycle_idx)</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#wepy.analysis.contig_tree.Contig.contig_trace_to_run_trace" title="wepy.analysis.contig_tree.Contig.contig_trace_to_run_trace"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Contig.contig_trace_to_run_trace()</span></code></a></dt><dd><p>calls this static method</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree.run_trace_to_contig_trace">
<code class="sig-name descname">run_trace_to_contig_trace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">run_trace</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree.run_trace_to_contig_trace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.run_trace_to_contig_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Assumes that the run trace goes along a valid contig.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>run_trace</strong> (<em>list of tuples of ints</em><em> (</em><em>run_idx</em><em>, </em><em>traj_idx</em><em>, </em><em>cycle_idx</em><em>)</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>contig_walker_trace</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuples of ints (traj_idx, contig_cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree.contig_cycle_idx">
<code class="sig-name descname">contig_cycle_idx</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">run_idx</span></em>, <em class="sig-param"><span class="n">cycle_idx</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree.contig_cycle_idx"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.contig_cycle_idx" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert an in-run cycle index to an in-contig cyle_idx.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>run_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Index of a run in the contig tree</p></li>
<li><p><strong>cycle_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Index of a cycle index within a run</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>contig_cycle_idx</strong> – The cycle idx in the contig</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree.get_branch_trace">
<code class="sig-name descname">get_branch_trace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">run_idx</span></em>, <em class="sig-param"><span class="n">cycle_idx</span></em>, <em class="sig-param"><span class="n">start_contig_idx</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree.get_branch_trace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.get_branch_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a contig trace for a branch of the contig tree from an end
point back to a set point (defaults to root of contig tree).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>run_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – </p></li>
<li><p><strong>cycle_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – An in-contig cycle index</p></li>
<li><p><strong>start_contig_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – <dl class="simple">
<dt>The in-contig cycle index where the “root” of the branch will start</dt><dd><p>(Default value = 0)</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>contig_trace</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuples of ints (run_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree.trace_parent_table">
<code class="sig-name descname">trace_parent_table</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contig_trace</span></em>, <em class="sig-param"><span class="n">discontinuities</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree.trace_parent_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.trace_parent_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a contig trace returns a parent table for that contig.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contig_trace</strong> (<em>list of tuples</em><em> (</em><em>run_idx</em><em>, </em><em>cycle_idx</em><em>)</em>) – </p></li>
<li><p><strong>discontinuities</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether or not to include discontinuities in the table.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>parent_table</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of list of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree._tree_leaves">
<em class="property">classmethod </em><code class="sig-name descname">_tree_leaves</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">root</span></em>, <em class="sig-param"><span class="n">tree</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree._tree_leaves"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree._tree_leaves" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the root node ID and the tree as a networkX DiGraph returns
the leaves of the tree.</p>
<p>Must give it the reversed tree because it is recursive.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root</strong> (<em>node_id</em>) – </p></li>
<li><p><strong>tree</strong> (<em>networkx.DiGraph</em>) – The reversed tree from the contigtree</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>leaves</strong> – The leaf node IDs of the tree.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of node_id</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree._subtree_leaves">
<code class="sig-name descname">_subtree_leaves</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">root</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree._subtree_leaves"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree._subtree_leaves" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a root defining a subtree on the full tree returns the leaves
of that subtree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>root</strong> (<em>node_id</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>leaves</strong> – The leaf node IDs of the tree.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of node_id</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree.leaves">
<code class="sig-name descname">leaves</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree.leaves"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.leaves" title="Permalink to this definition">¶</a></dt>
<dd><p>All of the leaves of this contig tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>leaves</strong> – The leaf node IDs of the tree.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list of node_id</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree.root_leaves">
<code class="sig-name descname">root_leaves</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree.root_leaves"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.root_leaves" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary mapping the roots to their leaves.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree._subtree_root">
<code class="sig-name descname">_subtree_root</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree._subtree_root"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree._subtree_root" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a node find the root of the tree it is on</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node</strong> (<em>node_id</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>root</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>node_id</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree.roots">
<code class="sig-name descname">roots</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree.roots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.roots" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all of the roots in this contig tree (which is technically
a forest and can have multiple roots).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>root</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list of node_id</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree.subtrees">
<code class="sig-name descname">subtrees</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree.subtrees"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.subtrees" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all of the subtrees (with unique roots) in this contig tree
(which is technically a forest and can have multiple
roots).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>subtrees</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list of networkx.DiGraph trees</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree.get_subtree">
<code class="sig-name descname">get_subtree</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree.get_subtree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.get_subtree" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a node defining a subtree root return that subtree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node</strong> (<em>node_id</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>subtree</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>networkx.DiGraph tree</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree.contig_sliding_windows">
<code class="sig-name descname">contig_sliding_windows</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contig_trace</span></em>, <em class="sig-param"><span class="n">window_length</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree.contig_sliding_windows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.contig_sliding_windows" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a contig trace get the sliding windows of length
‘window_length’ as contig walker traces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contig_trace</strong> (<em>list of tuples of ints</em><em> (</em><em>run_idx</em><em>, </em><em>cycle_idx</em><em>)</em>) – Trace defining a contig in the contig tree.</p></li>
<li><p><strong>window_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The length of the sliding windows to return.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>windows</strong> – List of contig walker traces</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of list of tuples of ints (traj_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree.sliding_contig_windows">
<code class="sig-name descname">sliding_contig_windows</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">window_length</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree.sliding_contig_windows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.sliding_contig_windows" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a ‘window_length’ return all the windows over the contig tree
as contig traces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>window_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>contig_windows</strong> – List of contig traces</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of list of tuples of ints (run_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree._subtree_sliding_contig_windows">
<code class="sig-name descname">_subtree_sliding_contig_windows</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">subtree_root</span></em>, <em class="sig-param"><span class="n">window_length</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree._subtree_sliding_contig_windows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree._subtree_sliding_contig_windows" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the sliding windows of length ‘window_length’ from the
subtree defined by the subtree root as run traces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subtree_root</strong> (<em>node_id</em>) – </p></li>
<li><p><strong>window_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>subtree_windows</strong> – List of the contig tree windows as contig traces</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of list of tuples of ints (run_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree.sliding_windows">
<code class="sig-name descname">sliding_windows</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">window_length</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree.sliding_windows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.sliding_windows" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all the sliding windows over walker trajectories as run
traces for a given window length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>window_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>windows</strong> – List of run traces.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of list of tuples of ints (run_idx, traj_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree._rec_spanning_paths">
<em class="property">classmethod </em><code class="sig-name descname">_rec_spanning_paths</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">edges</span></em>, <em class="sig-param"><span class="n">root</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree._rec_spanning_paths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree._rec_spanning_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a set of directed edges (source, target) and a root node id
of a tree imposed over the edges, returns all the paths over
that tree which span from the root to a leaf.</p>
<p>This is a recursive function and has pretty bad performance
for nontrivial simulations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edges</strong> (<em>(</em><em>node_id</em><em>, </em><em>node_id</em><em>)</em>) – </p></li>
<li><p><strong>root</strong> (<em>node_id</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>spanning_paths</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of edges</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree._spanning_paths">
<code class="sig-name descname">_spanning_paths</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">root</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree._spanning_paths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree._spanning_paths" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>root</strong> (<em>node_id</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>spanning_paths</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of list of edges</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree.spanning_contig_traces">
<code class="sig-name descname">spanning_contig_traces</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree.spanning_contig_traces"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree.spanning_contig_traces" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all possible spanning contigs given the
continuations present in this file. Spanning contigs are paths
through a tree that must start from a root node and end at a
leaf node.</p>
<p>This algorithm always returns them in a canonical order (as
long as the runs are not rearranged after being added). This
means that the indices here are the indices of the contigs.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>spanning_contig_traces</strong> – List of all spanning contigs which are contig traces.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list of list of tuples of ints (run_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree._root_spanning_contig_traces">
<code class="sig-name descname">_root_spanning_contig_traces</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree._root_spanning_contig_traces"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree._root_spanning_contig_traces" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all possible spanning contigs given the
continuations present in this file. Spanning contigs are paths
through a tree that must start from a root node and end at a
leaf node.</p>
<p>This algorithm always returns them in a canonical order (as
long as the runs are not rearranged after being added). This
means that the indices here are the indices of the contigs.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>spanning_contig_traces</strong> – Dictionary mapping the root ids to all spanning contigs
for it which are contig traces.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict of root_id to list of tuples of ints (run_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree._contig_trace_to_contig_runs">
<em class="property">classmethod </em><code class="sig-name descname">_contig_trace_to_contig_runs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contig_trace</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree._contig_trace_to_contig_runs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree._contig_trace_to_contig_runs" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a contig trace to a list of runs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>contig_trace</strong> (<em>list of tuples of ints</em><em> (</em><em>run_idx</em><em>, </em><em>cycle_idx</em><em>)</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>contig_runs</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree._contig_runs_to_continuations">
<em class="property">classmethod </em><code class="sig-name descname">_contig_runs_to_continuations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contig_runs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree._contig_runs_to_continuations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree._contig_runs_to_continuations" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to convert a list of run indices defining a contig
to continuations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>contig_runs</strong> (<em>list of int</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>continuations</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuple of int (run_idx, run_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.BaseContigTree._continuations_to_contig_runs">
<em class="property">classmethod </em><code class="sig-name descname">_continuations_to_contig_runs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">continuations</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#BaseContigTree._continuations_to_contig_runs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.BaseContigTree._continuations_to_contig_runs" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function that converts a list of continuations to a list of
the runs in the order of the contigs defined by the continuations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>continuations</strong> (<em>list of tuple of int</em><em> (</em><em>run_idx</em><em>, </em><em>run_idx</em><em>)</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>contig_runs</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="wepy.analysis.contig_tree.ContigTree">
<em class="property">class </em><code class="sig-prename descclassname">wepy.analysis.contig_tree.</code><code class="sig-name descname">ContigTree</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wepy_h5</span></em>, <em class="sig-param"><span class="n">base_contigtree</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">continuations</span><span class="o">=</span><span class="default_value">Ellipsis</span></em>, <em class="sig-param"><span class="n">runs</span><span class="o">=</span><span class="default_value">Ellipsis</span></em>, <em class="sig-param"><span class="n">boundary_condition_class</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">decision_class</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#ContigTree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#wepy.analysis.contig_tree.BaseContigTree" title="wepy.analysis.contig_tree.BaseContigTree"><code class="xref py py-class docutils literal notranslate"><span class="pre">wepy.analysis.contig_tree.BaseContigTree</span></code></a></p>
<p>Wraps a WepyHDF5 object and gives access to logical trajectories.</p>
<p>The contig tree is technically a forest (a collection of trees)
and can have multiple roots.</p>
<p>The only required argument is an WepyHDF5 object from which to draw
data.</p>
<p>If <cite>continuations</cite> is given it specifies the (continuing_run_idx,
continued_run_idx) continuations the contig tree will use. This
overrides anything in the WepyHDF5 file. Only use this if you know
what you are doing. If <cite>continuations</cite> is <cite>Ellipsis</cite> the
continuations from the <cite>WepyHDF5</cite> will be used.</p>
<p>If <cite>runs</cite> is not <cite>Ellipsis</cite> only these runs will be included in
the <cite>ContigTree</cite> and the continuations relvant to this subset will
be used.</p>
<p>If a valid <cite>decision_class</cite> is given walker lineages will be
generated. This class is largely useless without this.</p>
<p>The <cite>boundary_condition_class</cite> is only used in the presence of a
<cite>decision_class</cite>. A valid <cite>boundary_condition_class</cite> will detect
the discontinuities in walker trajectories and will automatically
apply them to divide up logical trajectories. Otherwise, if
discontinuous boundary condition warping events in data are
present logical trajectories will have discontinuities in them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wepy_h5</strong> (<em>closed WepyHDF5 object</em>) – </p></li>
<li><p><strong>continuations</strong> (<em>Ellipsis</em><em> (</em><em>use continuations in wepy_h5</em><em>) </em><em>or</em>) – <p>list of tuple of int (run_idx, run_idx)</p>
<dl class="simple">
<dt>The continuations to apply to the runs in this contig tree.</dt><dd><p>(Default value = Ellipsis)</p>
</dd>
</dl>
</p></li>
<li><p><strong>runs</strong> (<em>Ellipsis</em><em> (</em><em>use all runs in wepy_h5</em><em>) </em><em>or</em>) – <p>list of idx</p>
<dl class="simple">
<dt>The indices of the runs to use in the contig tree</dt><dd><p>(Default value = Ellipsis)</p>
</dd>
</dl>
</p></li>
<li><p><strong>boundary_condition_class</strong> (<em>class implementing BoundaryCondition</em>) – interface
(Default value = None)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>decision_class<span class="classifier">class implementing Decision interface</span></dt><dd><p>(Default value = None)</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Only set <cite>continuations</cite> if you know what you are doing.</p>
<p>A <cite>decision_class</cite> must be given to be able to detect cloning and
merging and get parental lineages.</p>
<p>Make sure to give the <cite>boundary_condition_class</cite> if there was
discontinuous warping events in the simulation or else you will
get erroneous contiguous trajectories.</p>
</div>
<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree._set_base_contigtree_to_self">
<code class="sig-name descname">_set_base_contigtree_to_self</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">base_contigtree</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#ContigTree._set_base_contigtree_to_self"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree._set_base_contigtree_to_self" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.open">
<code class="sig-name descname">open</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#ContigTree.open"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.open" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.close">
<code class="sig-name descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#ContigTree.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.close" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.base_contigtree">
<em class="property">property </em><code class="sig-name descname">base_contigtree</code><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.base_contigtree" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.wepy_h5">
<em class="property">property </em><code class="sig-name descname">wepy_h5</code><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.wepy_h5" title="Permalink to this definition">¶</a></dt>
<dd><p>The WepyHDF5 source object for which the contig tree is being constructed.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.make_contig">
<code class="sig-name descname">make_contig</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contig_trace</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#ContigTree.make_contig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.make_contig" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Contig object given a contig trace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>contig_trace</strong> (<em>list of tuples of ints</em><em> (</em><em>run_idx</em><em>, </em><em>cycle_idx</em><em>)</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>contig</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Contig object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.warp_trace">
<code class="sig-name descname">warp_trace</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#ContigTree.warp_trace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.warp_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the trace for all unique warping events from all contigs.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.resampling_trace">
<code class="sig-name descname">resampling_trace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">decision_id</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#ContigTree.resampling_trace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.resampling_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Return full run traces for every specified type of resampling
event.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>decision_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The string ID of the decision you want to match on and get
lineages for.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.final_trace">
<code class="sig-name descname">final_trace</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#ContigTree.final_trace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.final_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a trace of all the walkers at the end of the contig.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.lineages">
<code class="sig-name descname">lineages</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">trace</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#ContigTree.lineages"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.lineages" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the ancestry lineage for each element of the trace as a run
trace.</p>
</dd></dl>

<dl class="py attribute">
<dt id="wepy.analysis.contig_tree.ContigTree.DISCONTINUITY_KEY">
<code class="sig-name descname">DISCONTINUITY_KEY</code><em class="property"> = 'discontinuities'</em><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.DISCONTINUITY_KEY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="wepy.analysis.contig_tree.ContigTree.PARENTS_KEY">
<code class="sig-name descname">PARENTS_KEY</code><em class="property"> = 'parent_idxs'</em><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.PARENTS_KEY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="wepy.analysis.contig_tree.ContigTree.RESAMPLING_PANEL_KEY">
<code class="sig-name descname">RESAMPLING_PANEL_KEY</code><em class="property"> = 'resampling_steps'</em><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.RESAMPLING_PANEL_KEY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree._contig_runs_to_continuations">
<em class="property">classmethod </em><code class="sig-name descname">_contig_runs_to_continuations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contig_runs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree._contig_runs_to_continuations" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to convert a list of run indices defining a contig
to continuations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>contig_runs</strong> (<em>list of int</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>continuations</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuple of int (run_idx, run_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree._contig_trace_to_contig_runs">
<em class="property">classmethod </em><code class="sig-name descname">_contig_trace_to_contig_runs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contig_trace</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree._contig_trace_to_contig_runs" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a contig trace to a list of runs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>contig_trace</strong> (<em>list of tuples of ints</em><em> (</em><em>run_idx</em><em>, </em><em>cycle_idx</em><em>)</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>contig_runs</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree._continuations_to_contig_runs">
<em class="property">classmethod </em><code class="sig-name descname">_continuations_to_contig_runs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">continuations</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree._continuations_to_contig_runs" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function that converts a list of continuations to a list of
the runs in the order of the contigs defined by the continuations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>continuations</strong> (<em>list of tuple of int</em><em> (</em><em>run_idx</em><em>, </em><em>run_idx</em><em>)</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>contig_runs</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree._create_tree">
<code class="sig-name descname">_create_tree</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wepy_h5</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree._create_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the tree of cycles from the WepyHDF5 object/file.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree._rec_spanning_paths">
<em class="property">classmethod </em><code class="sig-name descname">_rec_spanning_paths</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">edges</span></em>, <em class="sig-param"><span class="n">root</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree._rec_spanning_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a set of directed edges (source, target) and a root node id
of a tree imposed over the edges, returns all the paths over
that tree which span from the root to a leaf.</p>
<p>This is a recursive function and has pretty bad performance
for nontrivial simulations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edges</strong> (<em>(</em><em>node_id</em><em>, </em><em>node_id</em><em>)</em>) – </p></li>
<li><p><strong>root</strong> (<em>node_id</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>spanning_paths</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of edges</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree._root_spanning_contig_traces">
<code class="sig-name descname">_root_spanning_contig_traces</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree._root_spanning_contig_traces" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all possible spanning contigs given the
continuations present in this file. Spanning contigs are paths
through a tree that must start from a root node and end at a
leaf node.</p>
<p>This algorithm always returns them in a canonical order (as
long as the runs are not rearranged after being added). This
means that the indices here are the indices of the contigs.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>spanning_contig_traces</strong> – Dictionary mapping the root ids to all spanning contigs
for it which are contig traces.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict of root_id to list of tuples of ints (run_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree._set_discontinuities">
<code class="sig-name descname">_set_discontinuities</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wepy_h5</span></em>, <em class="sig-param"><span class="n">boundary_conditions_class</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree._set_discontinuities" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the boundary condition class sets node attributes for where
there are discontinuities in the parental lineages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>boundary_conditions_class</strong> (<em>class implementing BoundaryCondition interface</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree._set_parents">
<code class="sig-name descname">_set_parents</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">decision_class</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree._set_parents" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the net parents for each cycle and sets them in-place to
the cycle tree given.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>decision_class</strong> (<em>class implementing Decision interface</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree._set_resampling_panels">
<code class="sig-name descname">_set_resampling_panels</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wepy_h5</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree._set_resampling_panels" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates resampling panels for each cycle and sets them as node attributes.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree._spanning_paths">
<code class="sig-name descname">_spanning_paths</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">root</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree._spanning_paths" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>root</strong> (<em>node_id</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>spanning_paths</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of list of edges</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree._subtree_leaves">
<code class="sig-name descname">_subtree_leaves</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">root</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree._subtree_leaves" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a root defining a subtree on the full tree returns the leaves
of that subtree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>root</strong> (<em>node_id</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>leaves</strong> – The leaf node IDs of the tree.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of node_id</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree._subtree_root">
<code class="sig-name descname">_subtree_root</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree._subtree_root" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a node find the root of the tree it is on</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node</strong> (<em>node_id</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>root</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>node_id</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree._subtree_sliding_contig_windows">
<code class="sig-name descname">_subtree_sliding_contig_windows</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">subtree_root</span></em>, <em class="sig-param"><span class="n">window_length</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree._subtree_sliding_contig_windows" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the sliding windows of length ‘window_length’ from the
subtree defined by the subtree root as run traces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subtree_root</strong> (<em>node_id</em>) – </p></li>
<li><p><strong>window_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>subtree_windows</strong> – List of the contig tree windows as contig traces</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of list of tuples of ints (run_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree._tree_leaves">
<em class="property">classmethod </em><code class="sig-name descname">_tree_leaves</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">root</span></em>, <em class="sig-param"><span class="n">tree</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree._tree_leaves" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the root node ID and the tree as a networkX DiGraph returns
the leaves of the tree.</p>
<p>Must give it the reversed tree because it is recursive.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root</strong> (<em>node_id</em>) – </p></li>
<li><p><strong>tree</strong> (<em>networkx.DiGraph</em>) – The reversed tree from the contigtree</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>leaves</strong> – The leaf node IDs of the tree.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of node_id</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.boundary_condition_class">
<em class="property">property </em><code class="sig-name descname">boundary_condition_class</code><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.boundary_condition_class" title="Permalink to this definition">¶</a></dt>
<dd><p>The boundary condition class is used to determine discontinuities in lineages.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.contig_cycle_idx">
<code class="sig-name descname">contig_cycle_idx</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">run_idx</span></em>, <em class="sig-param"><span class="n">cycle_idx</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.contig_cycle_idx" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert an in-run cycle index to an in-contig cyle_idx.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>run_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Index of a run in the contig tree</p></li>
<li><p><strong>cycle_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Index of a cycle index within a run</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>contig_cycle_idx</strong> – The cycle idx in the contig</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.contig_sliding_windows">
<code class="sig-name descname">contig_sliding_windows</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contig_trace</span></em>, <em class="sig-param"><span class="n">window_length</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.contig_sliding_windows" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a contig trace get the sliding windows of length
‘window_length’ as contig walker traces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contig_trace</strong> (<em>list of tuples of ints</em><em> (</em><em>run_idx</em><em>, </em><em>cycle_idx</em><em>)</em>) – Trace defining a contig in the contig tree.</p></li>
<li><p><strong>window_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The length of the sliding windows to return.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>windows</strong> – List of contig walker traces</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of list of tuples of ints (traj_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.contig_trace_to_run_trace">
<em class="property">static </em><code class="sig-name descname">contig_trace_to_run_trace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contig_trace</span></em>, <em class="sig-param"><span class="n">contig_walker_trace</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.contig_trace_to_run_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine a contig trace and a walker trace to get the equivalent run trace.</p>
<p>The contig_walker_trace cycle_idxs must be a subset of the
frame indices given by the contig_trace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contig_trace</strong> (<em>list of tuples of ints</em><em> (</em><em>run_idx</em><em>, </em><em>cycle_idx</em><em>)</em>) – </p></li>
<li><p><strong>contig_walker_trace</strong> (<em>list of tuples of ints</em><em> (</em><em>traj_idx</em><em>, </em><em>cycle_idx</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>run_trace</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuples of ints (run_idx, traj_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.continuations">
<em class="property">property </em><code class="sig-name descname">continuations</code><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.continuations" title="Permalink to this definition">¶</a></dt>
<dd><p>The continuations that are used in this contig tree over the runs.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.decision_class">
<em class="property">property </em><code class="sig-name descname">decision_class</code><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.decision_class" title="Permalink to this definition">¶</a></dt>
<dd><p>The decision class used to determine parental lineages.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.get_branch_trace">
<code class="sig-name descname">get_branch_trace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">run_idx</span></em>, <em class="sig-param"><span class="n">cycle_idx</span></em>, <em class="sig-param"><span class="n">start_contig_idx</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.get_branch_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a contig trace for a branch of the contig tree from an end
point back to a set point (defaults to root of contig tree).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>run_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – </p></li>
<li><p><strong>cycle_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – An in-contig cycle index</p></li>
<li><p><strong>start_contig_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – <dl class="simple">
<dt>The in-contig cycle index where the “root” of the branch will start</dt><dd><p>(Default value = 0)</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>contig_trace</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuples of ints (run_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.get_subtree">
<code class="sig-name descname">get_subtree</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.get_subtree" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a node defining a subtree root return that subtree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node</strong> (<em>node_id</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>subtree</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>networkx.DiGraph tree</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.graph">
<em class="property">property </em><code class="sig-name descname">graph</code><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.graph" title="Permalink to this definition">¶</a></dt>
<dd><p>The underlying networkx.DiGraph object.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.leaves">
<code class="sig-name descname">leaves</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.leaves" title="Permalink to this definition">¶</a></dt>
<dd><p>All of the leaves of this contig tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>leaves</strong> – The leaf node IDs of the tree.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list of node_id</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.root_leaves">
<code class="sig-name descname">root_leaves</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.root_leaves" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary mapping the roots to their leaves.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.roots">
<code class="sig-name descname">roots</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.roots" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all of the roots in this contig tree (which is technically
a forest and can have multiple roots).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>root</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list of node_id</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.run_idxs">
<em class="property">property </em><code class="sig-name descname">run_idxs</code><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.run_idxs" title="Permalink to this definition">¶</a></dt>
<dd><p>Indices of runs in WepyHDF5 used in this contig tree.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.run_trace_to_contig_trace">
<code class="sig-name descname">run_trace_to_contig_trace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">run_trace</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.run_trace_to_contig_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Assumes that the run trace goes along a valid contig.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>run_trace</strong> (<em>list of tuples of ints</em><em> (</em><em>run_idx</em><em>, </em><em>traj_idx</em><em>, </em><em>cycle_idx</em><em>)</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>contig_walker_trace</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuples of ints (traj_idx, contig_cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.sliding_contig_windows">
<code class="sig-name descname">sliding_contig_windows</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">window_length</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.sliding_contig_windows" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a ‘window_length’ return all the windows over the contig tree
as contig traces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>window_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>contig_windows</strong> – List of contig traces</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of list of tuples of ints (run_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.sliding_windows">
<code class="sig-name descname">sliding_windows</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">window_length</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.sliding_windows" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all the sliding windows over walker trajectories as run
traces for a given window length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>window_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>windows</strong> – List of run traces.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of list of tuples of ints (run_idx, traj_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.span_contig">
<code class="sig-name descname">span_contig</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">span_idx</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.span_contig" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a contig object for the specified spanning contig.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.span_traces">
<em class="property">property </em><code class="sig-name descname">span_traces</code><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.span_traces" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping the spand indices to their run traces.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.spanning_contig_traces">
<code class="sig-name descname">spanning_contig_traces</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.spanning_contig_traces" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all possible spanning contigs given the
continuations present in this file. Spanning contigs are paths
through a tree that must start from a root node and end at a
leaf node.</p>
<p>This algorithm always returns them in a canonical order (as
long as the runs are not rearranged after being added). This
means that the indices here are the indices of the contigs.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>spanning_contig_traces</strong> – List of all spanning contigs which are contig traces.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list of list of tuples of ints (run_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.subtrees">
<code class="sig-name descname">subtrees</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.subtrees" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all of the subtrees (with unique roots) in this contig tree
(which is technically a forest and can have multiple
roots).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>subtrees</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list of networkx.DiGraph trees</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.trace_parent_table">
<code class="sig-name descname">trace_parent_table</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contig_trace</span></em>, <em class="sig-param"><span class="n">discontinuities</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.trace_parent_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a contig trace returns a parent table for that contig.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contig_trace</strong> (<em>list of tuples</em><em> (</em><em>run_idx</em><em>, </em><em>cycle_idx</em><em>)</em>) – </p></li>
<li><p><strong>discontinuities</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether or not to include discontinuities in the table.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>parent_table</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of list of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.ContigTree.walker_trace_to_run_trace">
<code class="sig-name descname">walker_trace_to_run_trace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contig_walker_trace</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.ContigTree.walker_trace_to_run_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine a walker trace to get the equivalent run trace for this contig.</p>
<p>The contig_walker_trace cycle_idxs must be a subset of the
frame indices given by the contig_trace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>contig_walker_trace</strong> (<em>list of tuples of ints</em><em> (</em><em>traj_idx</em><em>, </em><em>cycle_idx</em><em>)</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>run_trace</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuples of ints (run_idx, traj_idx, cycle_idx)</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#wepy.analysis.contig_tree.Contig.contig_trace_to_run_trace" title="wepy.analysis.contig_tree.Contig.contig_trace_to_run_trace"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Contig.contig_trace_to_run_trace()</span></code></a></dt><dd><p>calls this static method</p>
</dd>
</dl>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="wepy.analysis.contig_tree.Contig">
<em class="property">class </em><code class="sig-prename descclassname">wepy.analysis.contig_tree.</code><code class="sig-name descname">Contig</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wepy_h5</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#wepy.analysis.contig_tree.ContigTree" title="wepy.analysis.contig_tree.ContigTree"><code class="xref py py-class docutils literal notranslate"><span class="pre">wepy.analysis.contig_tree.ContigTree</span></code></a></p>
<p>Wraps a WepyHDF5 object and gives access to logical trajectories
from a single contig.</p>
<p>This class is very similar to the ContigTree class and inherits
all of those methods. It adds methods for getting records and
other data about a single contig.</p>
<p>The only required argument is an WepyHDF5 object from which to draw
data.</p>
<p>If <cite>continuations</cite> is given it specifies the (continuing_run_idx,
continued_run_idx) continuations the contig tree will use. This
overrides anything in the WepyHDF5 file. Only use this if you know
what you are doing. If <cite>continuations</cite> is <cite>Ellipsis</cite> the
continuations from the <cite>WepyHDF5</cite> will be used.</p>
<p>If <cite>runs</cite> is not <cite>Ellipsis</cite> only these runs will be included in
the <cite>ContigTree</cite> and the continuations relvant to this subset will
be used.</p>
<p>If a valid <cite>decision_class</cite> is given walker lineages will be
generated. This class is largely useless without this.</p>
<p>The <cite>boundary_condition_class</cite> is only used in the presence of a
<cite>decision_class</cite>. A valid <cite>boundary_condition_class</cite> will detect
the discontinuities in walker trajectories and will automatically
apply them to divide up logical trajectories. Otherwise, if
discontinuous boundary condition warping events in data are
present logical trajectories will have discontinuities in them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wepy_h5</strong> (<em>closed WepyHDF5 object</em>) – </p></li>
<li><p><strong>continuations</strong> (<em>Ellipsis</em><em> (</em><em>use continuations in wepy_h5</em><em>) </em><em>or</em>) – <p>list of tuple of int (run_idx, run_idx)</p>
<dl class="simple">
<dt>The continuations to apply to the runs in this contig tree.</dt><dd><p>(Default value = Ellipsis)</p>
</dd>
</dl>
</p></li>
<li><p><strong>runs</strong> (<em>Ellipsis</em><em> (</em><em>use all runs in wepy_h5</em><em>) </em><em>or</em>) – <p>list of idx</p>
<dl class="simple">
<dt>The indices of the runs to use in the contig tree</dt><dd><p>(Default value = Ellipsis)</p>
</dd>
</dl>
</p></li>
<li><p><strong>boundary_condition_class</strong> (<em>class implementing BoundaryCondition</em>) – interface
(Default value = None)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>decision_class<span class="classifier">class implementing Decision interface</span></dt><dd><p>(Default value = None)</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Only set <cite>continuations</cite> if you know what you are doing.</p>
<p>A <cite>decision_class</cite> must be given to be able to detect cloning and
merging and get parental lineages.</p>
<p>Make sure to give the <cite>boundary_condition_class</cite> if there was
discontinuous warping events in the simulation or else you will
get erroneous contiguous trajectories.</p>
</div>
<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.contig_fields">
<code class="sig-name descname">contig_fields</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fields</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.contig_fields"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.contig_fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns trajectory field data for the specified fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fields</strong> (<em>list of str</em>) – The field keys you want to retrieve data for.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fields_dict</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict of str: numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.contig_trace">
<em class="property">property </em><code class="sig-name descname">contig_trace</code><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.contig_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the contig trace corresponding to this contig.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>contig_trace :: list of tuples of ints (run_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.num_cycles">
<em class="property">property </em><code class="sig-name descname">num_cycles</code><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.num_cycles" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of cycles in this contig.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>num_cycles</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.num_walkers">
<code class="sig-name descname">num_walkers</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cycle_idx</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.num_walkers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.num_walkers" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of walkers at a given cycle in the contig.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cycle_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>n_walkers</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.records">
<code class="sig-name descname">records</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">record_key</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.records"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.records" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the records for the given key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>record_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>records</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of namedtuple records</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.records_dataframe">
<code class="sig-name descname">records_dataframe</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">record_key</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.records_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.records_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the records as a pandas.DataFrame for the given key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>record_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>records_df</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.resampling_records">
<code class="sig-name descname">resampling_records</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.resampling_records"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.resampling_records" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the resampling records.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>resampling_records</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list of namedtuple records</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.resampling_records_dataframe">
<code class="sig-name descname">resampling_records_dataframe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.resampling_records_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.resampling_records_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the resampling records as a pandas.DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>resampling_df</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.resampler_records">
<code class="sig-name descname">resampler_records</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.resampler_records"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.resampler_records" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the resampler records.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>resampler_records</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list of namedtuple records</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.resampler_records_dataframe">
<code class="sig-name descname">resampler_records_dataframe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.resampler_records_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.resampler_records_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the resampler records as a pandas.DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>resampler_df</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.warping_records">
<code class="sig-name descname">warping_records</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.warping_records"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.warping_records" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the warping records.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>warping_records</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list of namedtuple records</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.warping_records_dataframe">
<code class="sig-name descname">warping_records_dataframe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.warping_records_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.warping_records_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the warping records as a pandas.DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>warping_df</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.bc_records">
<code class="sig-name descname">bc_records</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.bc_records"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.bc_records" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the boundary conditions records.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>bc_records</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list of namedtuple records</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.bc_records_dataframe">
<code class="sig-name descname">bc_records_dataframe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.bc_records_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.bc_records_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the boundary conditions records as a pandas.DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>bc_df</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.progress_records">
<code class="sig-name descname">progress_records</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.progress_records"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.progress_records" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the progress records.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>progress_records</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list of namedtuple records</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.progress_records_dataframe">
<code class="sig-name descname">progress_records_dataframe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.progress_records_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.progress_records_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the progress records as a pandas.DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>progress_df</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.resampling_panel">
<code class="sig-name descname">resampling_panel</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.resampling_panel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.resampling_panel" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the full resampling panel for this contig.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>resampling_panel</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list of list of list of namedtuple records</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.parent_table">
<code class="sig-name descname">parent_table</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">discontinuities</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.parent_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.parent_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the full parent table for this contig.</p>
<p class="rubric">Notes</p>
<p>This requires the decision class to be given to the Contig at
construction.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the simulation was run with boundary conditions that result
in discontinuous warping events and that class is not provided
at construction time to this class these discontinuities will
not be taken into account and not added to this parent table.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>parent_table</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list of list of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="wepy.analysis.contig_tree.Contig.DISCONTINUITY_KEY">
<code class="sig-name descname">DISCONTINUITY_KEY</code><em class="property"> = 'discontinuities'</em><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.DISCONTINUITY_KEY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="wepy.analysis.contig_tree.Contig.PARENTS_KEY">
<code class="sig-name descname">PARENTS_KEY</code><em class="property"> = 'parent_idxs'</em><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.PARENTS_KEY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="wepy.analysis.contig_tree.Contig.RESAMPLING_PANEL_KEY">
<code class="sig-name descname">RESAMPLING_PANEL_KEY</code><em class="property"> = 'resampling_steps'</em><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.RESAMPLING_PANEL_KEY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig._contig_runs_to_continuations">
<em class="property">classmethod </em><code class="sig-name descname">_contig_runs_to_continuations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contig_runs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig._contig_runs_to_continuations" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to convert a list of run indices defining a contig
to continuations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>contig_runs</strong> (<em>list of int</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>continuations</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuple of int (run_idx, run_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig._contig_trace_to_contig_runs">
<em class="property">classmethod </em><code class="sig-name descname">_contig_trace_to_contig_runs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contig_trace</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig._contig_trace_to_contig_runs" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a contig trace to a list of runs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>contig_trace</strong> (<em>list of tuples of ints</em><em> (</em><em>run_idx</em><em>, </em><em>cycle_idx</em><em>)</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>contig_runs</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig._continuations_to_contig_runs">
<em class="property">classmethod </em><code class="sig-name descname">_continuations_to_contig_runs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">continuations</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig._continuations_to_contig_runs" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function that converts a list of continuations to a list of
the runs in the order of the contigs defined by the continuations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>continuations</strong> (<em>list of tuple of int</em><em> (</em><em>run_idx</em><em>, </em><em>run_idx</em><em>)</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>contig_runs</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig._create_tree">
<code class="sig-name descname">_create_tree</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wepy_h5</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig._create_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the tree of cycles from the WepyHDF5 object/file.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig._rec_spanning_paths">
<em class="property">classmethod </em><code class="sig-name descname">_rec_spanning_paths</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">edges</span></em>, <em class="sig-param"><span class="n">root</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig._rec_spanning_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a set of directed edges (source, target) and a root node id
of a tree imposed over the edges, returns all the paths over
that tree which span from the root to a leaf.</p>
<p>This is a recursive function and has pretty bad performance
for nontrivial simulations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edges</strong> (<em>(</em><em>node_id</em><em>, </em><em>node_id</em><em>)</em>) – </p></li>
<li><p><strong>root</strong> (<em>node_id</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>spanning_paths</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of edges</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig._root_spanning_contig_traces">
<code class="sig-name descname">_root_spanning_contig_traces</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig._root_spanning_contig_traces" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all possible spanning contigs given the
continuations present in this file. Spanning contigs are paths
through a tree that must start from a root node and end at a
leaf node.</p>
<p>This algorithm always returns them in a canonical order (as
long as the runs are not rearranged after being added). This
means that the indices here are the indices of the contigs.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>spanning_contig_traces</strong> – Dictionary mapping the root ids to all spanning contigs
for it which are contig traces.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict of root_id to list of tuples of ints (run_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig._set_base_contigtree_to_self">
<code class="sig-name descname">_set_base_contigtree_to_self</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">base_contigtree</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig._set_base_contigtree_to_self" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig._set_discontinuities">
<code class="sig-name descname">_set_discontinuities</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wepy_h5</span></em>, <em class="sig-param"><span class="n">boundary_conditions_class</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig._set_discontinuities" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the boundary condition class sets node attributes for where
there are discontinuities in the parental lineages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>boundary_conditions_class</strong> (<em>class implementing BoundaryCondition interface</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig._set_parents">
<code class="sig-name descname">_set_parents</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">decision_class</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig._set_parents" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the net parents for each cycle and sets them in-place to
the cycle tree given.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>decision_class</strong> (<em>class implementing Decision interface</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig._set_resampling_panels">
<code class="sig-name descname">_set_resampling_panels</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wepy_h5</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig._set_resampling_panels" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates resampling panels for each cycle and sets them as node attributes.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig._spanning_paths">
<code class="sig-name descname">_spanning_paths</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">root</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig._spanning_paths" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>root</strong> (<em>node_id</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>spanning_paths</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of list of edges</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig._subtree_leaves">
<code class="sig-name descname">_subtree_leaves</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">root</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig._subtree_leaves" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a root defining a subtree on the full tree returns the leaves
of that subtree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>root</strong> (<em>node_id</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>leaves</strong> – The leaf node IDs of the tree.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of node_id</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig._subtree_root">
<code class="sig-name descname">_subtree_root</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig._subtree_root" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a node find the root of the tree it is on</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node</strong> (<em>node_id</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>root</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>node_id</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig._subtree_sliding_contig_windows">
<code class="sig-name descname">_subtree_sliding_contig_windows</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">subtree_root</span></em>, <em class="sig-param"><span class="n">window_length</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig._subtree_sliding_contig_windows" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the sliding windows of length ‘window_length’ from the
subtree defined by the subtree root as run traces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subtree_root</strong> (<em>node_id</em>) – </p></li>
<li><p><strong>window_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>subtree_windows</strong> – List of the contig tree windows as contig traces</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of list of tuples of ints (run_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig._tree_leaves">
<em class="property">classmethod </em><code class="sig-name descname">_tree_leaves</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">root</span></em>, <em class="sig-param"><span class="n">tree</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig._tree_leaves" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the root node ID and the tree as a networkX DiGraph returns
the leaves of the tree.</p>
<p>Must give it the reversed tree because it is recursive.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root</strong> (<em>node_id</em>) – </p></li>
<li><p><strong>tree</strong> (<em>networkx.DiGraph</em>) – The reversed tree from the contigtree</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>leaves</strong> – The leaf node IDs of the tree.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of node_id</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.base_contigtree">
<em class="property">property </em><code class="sig-name descname">base_contigtree</code><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.base_contigtree" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.boundary_condition_class">
<em class="property">property </em><code class="sig-name descname">boundary_condition_class</code><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.boundary_condition_class" title="Permalink to this definition">¶</a></dt>
<dd><p>The boundary condition class is used to determine discontinuities in lineages.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.close">
<code class="sig-name descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.close" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.contig_cycle_idx">
<code class="sig-name descname">contig_cycle_idx</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">run_idx</span></em>, <em class="sig-param"><span class="n">cycle_idx</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.contig_cycle_idx" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert an in-run cycle index to an in-contig cyle_idx.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>run_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Index of a run in the contig tree</p></li>
<li><p><strong>cycle_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Index of a cycle index within a run</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>contig_cycle_idx</strong> – The cycle idx in the contig</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.contig_sliding_windows">
<code class="sig-name descname">contig_sliding_windows</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contig_trace</span></em>, <em class="sig-param"><span class="n">window_length</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.contig_sliding_windows" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a contig trace get the sliding windows of length
‘window_length’ as contig walker traces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contig_trace</strong> (<em>list of tuples of ints</em><em> (</em><em>run_idx</em><em>, </em><em>cycle_idx</em><em>)</em>) – Trace defining a contig in the contig tree.</p></li>
<li><p><strong>window_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The length of the sliding windows to return.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>windows</strong> – List of contig walker traces</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of list of tuples of ints (traj_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.contig_trace_to_run_trace">
<em class="property">static </em><code class="sig-name descname">contig_trace_to_run_trace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contig_trace</span></em>, <em class="sig-param"><span class="n">contig_walker_trace</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.contig_trace_to_run_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine a contig trace and a walker trace to get the equivalent run trace.</p>
<p>The contig_walker_trace cycle_idxs must be a subset of the
frame indices given by the contig_trace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contig_trace</strong> (<em>list of tuples of ints</em><em> (</em><em>run_idx</em><em>, </em><em>cycle_idx</em><em>)</em>) – </p></li>
<li><p><strong>contig_walker_trace</strong> (<em>list of tuples of ints</em><em> (</em><em>traj_idx</em><em>, </em><em>cycle_idx</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>run_trace</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuples of ints (run_idx, traj_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.continuations">
<em class="property">property </em><code class="sig-name descname">continuations</code><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.continuations" title="Permalink to this definition">¶</a></dt>
<dd><p>The continuations that are used in this contig tree over the runs.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.decision_class">
<em class="property">property </em><code class="sig-name descname">decision_class</code><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.decision_class" title="Permalink to this definition">¶</a></dt>
<dd><p>The decision class used to determine parental lineages.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.get_branch_trace">
<code class="sig-name descname">get_branch_trace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">run_idx</span></em>, <em class="sig-param"><span class="n">cycle_idx</span></em>, <em class="sig-param"><span class="n">start_contig_idx</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.get_branch_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a contig trace for a branch of the contig tree from an end
point back to a set point (defaults to root of contig tree).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>run_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – </p></li>
<li><p><strong>cycle_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – An in-contig cycle index</p></li>
<li><p><strong>start_contig_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – <dl class="simple">
<dt>The in-contig cycle index where the “root” of the branch will start</dt><dd><p>(Default value = 0)</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>contig_trace</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuples of ints (run_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.get_subtree">
<code class="sig-name descname">get_subtree</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.get_subtree" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a node defining a subtree root return that subtree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node</strong> (<em>node_id</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>subtree</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>networkx.DiGraph tree</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.graph">
<em class="property">property </em><code class="sig-name descname">graph</code><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.graph" title="Permalink to this definition">¶</a></dt>
<dd><p>The underlying networkx.DiGraph object.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.leaves">
<code class="sig-name descname">leaves</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.leaves" title="Permalink to this definition">¶</a></dt>
<dd><p>All of the leaves of this contig tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>leaves</strong> – The leaf node IDs of the tree.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list of node_id</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.lineages_contig">
<code class="sig-name descname">lineages_contig</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contig_trace</span></em>, <em class="sig-param"><span class="n">discontinuities</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.lineages_contig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.lineages_contig" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.make_contig">
<code class="sig-name descname">make_contig</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contig_trace</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.make_contig" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Contig object given a contig trace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>contig_trace</strong> (<em>list of tuples of ints</em><em> (</em><em>run_idx</em><em>, </em><em>cycle_idx</em><em>)</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>contig</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Contig object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.open">
<code class="sig-name descname">open</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.open" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.root_leaves">
<code class="sig-name descname">root_leaves</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.root_leaves" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary mapping the roots to their leaves.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.roots">
<code class="sig-name descname">roots</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.roots" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all of the roots in this contig tree (which is technically
a forest and can have multiple roots).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>root</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list of node_id</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.run_idxs">
<em class="property">property </em><code class="sig-name descname">run_idxs</code><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.run_idxs" title="Permalink to this definition">¶</a></dt>
<dd><p>Indices of runs in WepyHDF5 used in this contig tree.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.run_trace_to_contig_trace">
<code class="sig-name descname">run_trace_to_contig_trace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">run_trace</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.run_trace_to_contig_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Assumes that the run trace goes along a valid contig.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>run_trace</strong> (<em>list of tuples of ints</em><em> (</em><em>run_idx</em><em>, </em><em>traj_idx</em><em>, </em><em>cycle_idx</em><em>)</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>contig_walker_trace</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuples of ints (traj_idx, contig_cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.sliding_contig_windows">
<code class="sig-name descname">sliding_contig_windows</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">window_length</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.sliding_contig_windows" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a ‘window_length’ return all the windows over the contig tree
as contig traces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>window_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>contig_windows</strong> – List of contig traces</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of list of tuples of ints (run_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.sliding_windows">
<code class="sig-name descname">sliding_windows</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">window_length</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.sliding_windows" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all the sliding windows over walker trajectories as run
traces for a given window length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>window_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>windows</strong> – List of run traces.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of list of tuples of ints (run_idx, traj_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.span_contig">
<code class="sig-name descname">span_contig</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">span_idx</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.span_contig" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a contig object for the specified spanning contig.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.span_traces">
<em class="property">property </em><code class="sig-name descname">span_traces</code><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.span_traces" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping the spand indices to their run traces.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.spanning_contig_traces">
<code class="sig-name descname">spanning_contig_traces</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.spanning_contig_traces" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all possible spanning contigs given the
continuations present in this file. Spanning contigs are paths
through a tree that must start from a root node and end at a
leaf node.</p>
<p>This algorithm always returns them in a canonical order (as
long as the runs are not rearranged after being added). This
means that the indices here are the indices of the contigs.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>spanning_contig_traces</strong> – List of all spanning contigs which are contig traces.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list of list of tuples of ints (run_idx, cycle_idx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.subtrees">
<code class="sig-name descname">subtrees</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.subtrees" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all of the subtrees (with unique roots) in this contig tree
(which is technically a forest and can have multiple
roots).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>subtrees</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list of networkx.DiGraph trees</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.trace_parent_table">
<code class="sig-name descname">trace_parent_table</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contig_trace</span></em>, <em class="sig-param"><span class="n">discontinuities</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.trace_parent_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a contig trace returns a parent table for that contig.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contig_trace</strong> (<em>list of tuples</em><em> (</em><em>run_idx</em><em>, </em><em>cycle_idx</em><em>)</em>) – </p></li>
<li><p><strong>discontinuities</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether or not to include discontinuities in the table.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>parent_table</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of list of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.walker_trace_to_run_trace">
<code class="sig-name descname">walker_trace_to_run_trace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contig_walker_trace</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.walker_trace_to_run_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine a walker trace to get the equivalent run trace for this contig.</p>
<p>The contig_walker_trace cycle_idxs must be a subset of the
frame indices given by the contig_trace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>contig_walker_trace</strong> (<em>list of tuples of ints</em><em> (</em><em>traj_idx</em><em>, </em><em>cycle_idx</em><em>)</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>run_trace</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuples of ints (run_idx, traj_idx, cycle_idx)</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#wepy.analysis.contig_tree.Contig.contig_trace_to_run_trace" title="wepy.analysis.contig_tree.Contig.contig_trace_to_run_trace"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Contig.contig_trace_to_run_trace()</span></code></a></dt><dd><p>calls this static method</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.wepy_h5">
<em class="property">property </em><code class="sig-name descname">wepy_h5</code><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.wepy_h5" title="Permalink to this definition">¶</a></dt>
<dd><p>The WepyHDF5 source object for which the contig tree is being constructed.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.lineages">
<code class="sig-name descname">lineages</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contig_trace</span></em>, <em class="sig-param"><span class="n">discontinuities</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.lineages"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.lineages" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the ancestry lineage for each element of the trace as a run
trace.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.warp_contig_trace">
<code class="sig-name descname">warp_contig_trace</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.warp_contig_trace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.warp_contig_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a trace that gives all of the walkers that were warped.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.resampling_contig_trace">
<code class="sig-name descname">resampling_contig_trace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">decision_id</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.resampling_contig_trace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.resampling_contig_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Return full run traces for every specified type of resampling
event.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>decision_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The integer ID of the decision you want to match on and get
lineages for. This is the integer value of the decision
enumeration value.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.final_contig_trace">
<code class="sig-name descname">final_contig_trace</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.final_contig_trace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.final_contig_trace" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.warp_trace">
<code class="sig-name descname">warp_trace</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.warp_trace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.warp_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a run trace that gives all of the walkers that were warped.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.resampling_trace">
<code class="sig-name descname">resampling_trace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">decision_id</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.resampling_trace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.resampling_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Return full run traces for every specified type of resampling
event.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>decision_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The string ID of the decision you want to match on and get
lineages for.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.final_trace">
<code class="sig-name descname">final_trace</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.final_trace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.final_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a trace of all the walkers at the end of the contig.</p>
</dd></dl>

<dl class="py method">
<dt id="wepy.analysis.contig_tree.Contig.resampling_tree_layout_graph">
<code class="sig-name descname">resampling_tree_layout_graph</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bc_class</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">progress_key</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">node_shape</span><span class="o">=</span><span class="default_value">'disc'</span></em>, <em class="sig-param"><span class="n">discontinuous_node_shape</span><span class="o">=</span><span class="default_value">'square'</span></em>, <em class="sig-param"><span class="n">colormap_name</span><span class="o">=</span><span class="default_value">'plasma'</span></em>, <em class="sig-param"><span class="n">node_radius</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">row_spacing</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">step_spacing</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">central_axis</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wepy/analysis/contig_tree.html#Contig.resampling_tree_layout_graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wepy.analysis.contig_tree.Contig.resampling_tree_layout_graph" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/wepy.svg" alt="Logo"/>
    
    <h1 class="logo logo-name">wepy</h1>
    
  </a>
</p>



<p class="blurb">Wepy Documentation</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=ADicksonLab&repo=wepy&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../_source/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_source/quick_start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_source/introduction.html">Introduction &amp; Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_source/introduction.html#bibliography">Bibliography</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../_source/tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_source/users_guide.html">User’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_source/troubleshooting.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_source/reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_source/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_source/api.html">API Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_api/modules.html">Full API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../_source/general_info.html">General Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_source/news.html">News and Updates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_source/changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_source/dev_guide.html">Development Guide</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Samuel D. Lotz.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/api/wepy.analysis.contig_tree.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>